snmpwalk
----------

Omnia can query known switches (by IP and community string) for information on target node MAC IDs. The following parameters need to be populated in ``input/provision_config.yml`` to discover target nodes using SNMP.

**Pre requisites**

SNMPv2 should be enabled on the switch specified using ``pxe_switch_ip`` in ``input/provision_config``.

To enable SNMPv2, log in to the switch and run the following commands: ::

    configure terminal
    snmp-server community public ro
    exit

Use ``show snmp community`` to verify your changes.

.. note:: The commands provided above sets the SNMP community string of the switch to ``public``. Ensure that the community string set above matches the value provided in ``pxe_switch_snmp_community_string`` in ``input/provision_config.yml``

.. warning:: Target servers with LOM architecture is not supported.

+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Parameter              | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+========================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| network_interface_type | The network type used on the Omnia cluster.                                                                                                                                                                                                                                                                                                                                                                                                              |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      Choices:                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      * ``lom`` <- default                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                        |      * ``dedicated``                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| discovery_mechanism    | The mechanism through which Omnia will discover nodes for provisioning.   For more information on how the mechanisms work, go to `DiscoveryMechanisms   <DiscoveryMechanisms/index.html>`_.                                                                                                                                                                                                                                                              |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      Choices:                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      * ``switch_based`` <-default                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                        |      * ``mapping``                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                        |      * ``bmc``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``snmpwalk``                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_os           | The operating system to be provisioned on target nodes in the   cluster.                                                                                                                                                                                                                                                                                                                                                                                 |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      Choices:                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      * ``rhel`` <-default                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                        |      * ``rocky``                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_os_version   | OS version of provision_os to be installed.                                                                                                                                                                                                                                                                                                                                                                                                              |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      Choices:                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      * ``8.0``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.1``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.2``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.3``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.4``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.5``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``8.6``  <- default                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                        |      * ``8.7``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| iso_file_path          | Path where user has placed the iso image that needs to be provisioned on   target nodes. Accepted files are Rocky8-DVD or RHEL-8.x-DVD (full OS).  iso_file_path  should contain the  provision_os  and    provision_os_version  values in   the  filename.                                                                                                                                                                                              |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**:   ``"/home/RHEL-8.6.0-20220420.3-x86_64-dvd1.iso"``                                                                                                                                                                                                                                                                                                                                                                             |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| timezone               | Timezone to be used during OS provisioning. Available timezones are   provided `here <../../Appendix.html>`_.                                                                                                                                                                                                                                                                                                                                            |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      Choices:                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      * ``GMT`` <- default                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                        |      * ``EST``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``CET``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``MST``                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                        |      * ``CST6CDT``                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                        |      * ``PST8PDT``                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| language               | Language to be used during OS provisioning.                                                                                                                                                                                                                                                                                                                                                                                                              |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**: ``en-US``                                                                                                                                                                                                                                                                                                                                                                                                                       |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| default_lease_time     | Default lease time for IPs assigned by DHCP. Range: 21600-86400                                                                                                                                                                                                                                                                                                                                                                                          |
|      ``integer``       |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**: ``86400``                                                                                                                                                                                                                                                                                                                                                                                                                       |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_password     | * Password set for the root account of target nodes during   provisioning.                                                                                                                                                                                                                                                                                                                                                                               |
|      ``string``        |      * Length >= 8 characters                                                                                                                                                                                                                                                                                                                                                                                                                            |
|      Required          |      * Password must not contain -,\, ',"                                                                                                                                                                                                                                                                                                                                                                                                                |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| postgresdb_password    | * Password set for the postgresDB on target nodes during   provisioning.                                                                                                                                                                                                                                                                                                                                                                                 |
|      ``string``        |      * Length >= 8 characters                                                                                                                                                                                                                                                                                                                                                                                                                            |
|      Required          |      * Password must not contain -,\, ',"                                                                                                                                                                                                                                                                                                                                                                                                                |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| node_name              | * Prefix for target node names, if dynamically allocated.                                                                                                                                                                                                                                                                                                                                                                                                |
|      ``string``        |      * Hostname = node_name + '0000x' + domain_name                                                                                                                                                                                                                                                                                                                                                                                                      |
|      Required          |      * Hostname <= 65 characters                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                        |      * Example: servernode00001.Omnia.test , where  node_name =servernode,  domain_name =Omnia.test , 00001 used by   Omnia.                                                                                                                                                                                                                                                                                                                             |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      **Default values**: ``node``                                                                                                                                                                                                                                                                                                                                                                                                                        |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| domain_name            | * Domain name the user intends to configure on the cluster.                                                                                                                                                                                                                                                                                                                                                                                              |
|      ``string``        |      * Hostname = node_name + '0000x' + domain_name                                                                                                                                                                                                                                                                                                                                                                                                      |
|      Required          |      * Hostname <= 65 characters                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                        |      * Please provide a valid domain name according to the domain name   standards.                                                                                                                                                                                                                                                                                                                                                                      |
|                        |      * Example: servernode00001.Omnia.test , where node_name=servernode,   domain_name=Omnia.test , 00001 used by Omnia.                                                                                                                                                                                                                                                                                                                                 |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| public_nic             | The nic/ethernet card that is connected to the public internet.                                                                                                                                                                                                                                                                                                                                                                                          |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**: ``eno2``                                                                                                                                                                                                                                                                                                                                                                                                                        |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_nic              | Admin NIC of Control Plane. This is the shared LOM NIC.                                                                                                                                                                                                                                                                                                                                                                                                  |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**: ``eno1``                                                                                                                                                                                                                                                                                                                                                                                                                        |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_nic_subnet *     | The subnet within which all Admin IPs are assigned.                                                                                                                                                                                                                                                                                                                                                                                                      |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Required          |      **Default values**: ``10.5.0.0``                                                                                                                                                                                                                                                                                                                                                                                                                    |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| primary_dns            | The primary DNS host IP queried to provide Internet access to Compute   Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                      |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Optional          |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| secondary_dns          | The secondary DNS host IP queried to provide Internet access to Compute   Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                    |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Optional          |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| disk_partition         | User defined disk partition applied to remote servers. The disk partition   desired_capacity has to be provided in MB. Valid mount_point values accepted   for disk partition are /home, /var, /tmp, /usr, swap. Default partition size   provided for /boot is 1024MB, /boot/efi is 256MB and the remaining space to /   partition.  Values are accepted in the   form of JSON list such as: , - { mount_point: "/home",   desired_capacity: "102400" } |
|      ``JSON list``     |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Optional          |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                        |      **Default values**: ``- { mount_point: "", desired_capacity:   "" }``                                                                                                                                                                                                                                                                                                                                                                               |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mlnx_ofed_path         | Absolute path to a  local copy of   the .iso file containing Mellanox OFED packages. The image can be downloaded   from https://network.nvidia.com/products/infiniband-drivers/linux/mlnx_ofed/.  Sample value:    /root/MLNX_OFED_LINUX-5.8-1.1.2.1-rhel8.6-x86_64.iso                                                                                                                                                                                  |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Optional          |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cuda_toolkit_path      | Absolute path to local copy of .rpm file containing CUDA packages. The   cuda rpm can be downloaded from https://developer.nvidia.com/cuda-downloads.   CUDA will be installed post provisioning without any user intervention. Eg:   cuda_toolkit_path: "/root/cuda-repo-rhel8-12-0-local-12.0.0_525.60.13-1.x86_64.rpm"                                                                                                                                |
|      ``string``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      Optional          |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
.. warning:: The IP address *192.168.25.x* is used for PowerVault Storage communications. Therefore, do not use this IP address for other configurations.

.. note::

    The ``input/provision_config.yml`` file is encrypted on the first run of the provision tool:
        To view the encrypted parameters: ::

            ansible-vault view provision_config.yml --vault-password-file .provision_vault_key

        To edit the encrypted parameters: ::

            ansible-vault edit provision_config.yml --vault-password-file .provision_vault_key



To continue to the next steps:

* `Provisioning the cluster <../installprovisiontool.html>`_