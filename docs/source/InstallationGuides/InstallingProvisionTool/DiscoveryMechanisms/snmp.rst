snmpwalk
----------

Omnia can query known switches (by IP and community string) for information on target node MAC IDs. The following parameters need to be populated in ``input/provision_config.yml`` to discover target nodes using SNMP.

**Pre requisites**

SNMPv2 should be enabled on the switch specified using ``pxe_switch_ip`` in ``input/provision_config``.

To enable SNMPv2, log in to the switch and run the following commands: ::

    configure terminal
    snmp-server community public ro
    exit

Use ``show snmp community`` to verify your changes.

.. note:: The commands provided above sets the SNMP community string of the switch to ``public``. Ensure that the community string set above matches the value provided in ``pxe_switch_snmp_community_string`` in ``input/provision_config.yml``

.. warning:: Target servers with LOM architecture is not supported.

+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Variable                         | Required (?) | Default, Choices                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+==================================+==============+=================================================+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| network_interface_type           | [Required]   | * **lom**                                       | The network type used on the   Omnia cluster.                                                                                                                                                                                                                                                                                                                                                                                                            |
|                                  |              | * dedicated                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| discovery_mechanism              | [Required]   | * **switch_based**                              | The mechanism through which   Omnia will discover nodes for provisioning. For more information on how the   mechanisms work, go to `DiscoveryMechanisms   <DiscoveryMechanisms/index.html>`_.                                                                                                                                                                                                                                                            |
|                                  |              | * mapping                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * bmc                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * snmpwalk                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_os                     | [Required]   | **rhel**, rocky                                 | The operating system to be   provisioned on target nodes in the cluster.                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_os_version             | [Required]   | * 8.0                                           | OS version of provision_os to be   installed.                                                                                                                                                                                                                                                                                                                                                                                                            |
|                                  |              | * 8.1                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * 8.2                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * 8.3                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * 8.4                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * 8.5                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * **8.6**                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * 8.7                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| iso_file_path                    | [Required]   | "/home/RHEL-8.6.0-20220420.3-x86_64-dvd1.iso"   | Path where user has placed the   iso image that needs to be provisioned on target nodes. Accepted files are   Rocky8-DVD or RHEL-8.x-DVD (full OS).    iso_file_path  should contain   the  provision_os  and    provision_os_version  values in   the  filename.                                                                                                                                                                                        |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| timezone                         | [Required]   | * **GMT**                                       | Timezone to be used during OS   provisioning. Available timezones are provided `here   <../../Appendix.html>`_.                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * EST                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * CET                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * MST                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * CST6CDT                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                  |              | * PST8PDT                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| language                         | [Required]   | **en-US**                                       | Language to be used during OS   provisioning.                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| default_lease_time               | [Required]   | **86400** [21600-86400]                         | Default lease time for IPs   assigned by DHCP                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| provision_password               | [Required]   |                                                 | * Password set for the root   account of target nodes during provisioning.                                                                                                                                                                                                                                                                                                                                                                               |
|                                  |              |                                                 | * Length >= 8 characters                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                  |              |                                                 | * Password must not contain -,\, ',"                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| postgresdb_password              | [Required]   |                                                 | * Password set for the   postgresDB on target nodes during provisioning.                                                                                                                                                                                                                                                                                                                                                                                 |
|                                  |              |                                                 | * Length >= 8 characters                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                  |              |                                                 | * Password must not contain -,\, ',"                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| node_name                        | [Required]   | node                                            | * Prefix for target node names,   if dynamically allocated.                                                                                                                                                                                                                                                                                                                                                                                              |
|                                  |              |                                                 | * Hostname = node_name + '0000x' + domain_name                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                  |              |                                                 | * Hostname <= 65 characters                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                  |              |                                                 | * Example: servernode00001.Omnia.test , where  node_name =servernode,  domain_name =Omnia.test , 00001 used by   Omnia.                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| domain_name                      | [Required]   |                                                 | * Domain name the user intends   to configure on the cluster.                                                                                                                                                                                                                                                                                                                                                                                            |
|                                  |              |                                                 | * Hostname = node_name + '0000x' + domain_name                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                  |              |                                                 | * Hostname <= 65 characters                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                  |              |                                                 | * Please provide a valid domain name according to the domain name   standards.                                                                                                                                                                                                                                                                                                                                                                           |
|                                  |              |                                                 | * Example: servernode00001.Omnia.test , where node_name=servernode,   domain_name=Omnia.test , 00001 used by Omnia.                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| public_nic                       | [Required]   | eno2                                            | The nic/ethernet card that is   connected to the public internet.                                                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_nic                        | [Required]   | eno1                                            | Admin NIC of Control Plane. This   is the shared LOM NIC.                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_nic_subnet   *             | [Required]   | 10.5.0.0                                        | The subnet within which all   Admin IPs are assigned.                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ib_nic_subnet                    | [Optional]   |                                                 | If provided, Omnia will handle   and assign static IPs to compute node's IB network.  If provided the db entry will be in   parallel with the  pxe_subnet .   Example: If admin_ip: 10.5.0.50 and ib_nic_subnet: 10.10.0.0, then ib_ip:   10.10.0.50. **Note:** Ensure that IB NICs have ib as a prefix.                                                                                                                                                 |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| pxe_switch_ip                    | [ Optional]  |                                                 | PXE switch that will be   connected to all iDRACs for provisioning. This switch needs to be   SNMP-enabled.                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| pxe_switch_snmp_community_string | [ Optional]  | public                                          | The SNMP community string used   to access statistics, MAC addresses and IPs stored within a router or other   device.                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| primary_dns                      | [ Optional]  |                                                 | The primary DNS host IP queried   to provide Internet access to Compute Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| secondary_dns                    | [ Optional]  |                                                 | The secondary DNS host IP   queried to provide Internet access to Compute Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| disk_partition                   | [ Optional]  |     - { mount_point: "", desired_capacity: "" } | User defined disk partition   applied to remote servers. The disk partition desired_capacity has to be   provided in MB. Valid mount_point values accepted for disk partition are   /home, /var, /tmp, /usr, swap. Default partition size provided for /boot is   1024MB, /boot/efi is 256MB and the remaining space to / partition.  Values are accepted in the form of JSON   list such as: , - { mount_point: "/home", desired_capacity:   "102400" } |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mlnx_ofed_path                   | [ Optional]  |                                                 | Absolute path to a  local copy of the .iso file containing   Mellanox OFED packages. The image can be downloaded from   https://network.nvidia.com/products/infiniband-drivers/linux/mlnx_ofed/.  Sample value:    /root/MLNX_OFED_LINUX-5.8-1.1.2.1-rhel8.6-x86_64.iso                                                                                                                                                                                  |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cuda_toolkit_path                | [ Optional]  |                                                 | Absolute path to local copy of   .rpm file containing CUDA packages. The cuda rpm can be downloaded from   https://developer.nvidia.com/cuda-downloads. CUDA will be installed post   provisioning without any user intervention. Eg: cuda_toolkit_path:   "/root/cuda-repo-rhel8-12-0-local-12.0.0_525.60.13-1.x86_64.rpm"                                                                                                                              |
+----------------------------------+--------------+-------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. warning:: The IP address *192.168.25.x* is used for PowerVault Storage communications. Therefore, do not use this IP address for other configurations.


To continue to the next steps:

* `Provisioning the cluster <../installprovisiontool.html>`_