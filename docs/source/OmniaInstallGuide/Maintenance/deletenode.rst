Delete provisioned node
========================

Use this playbook to remove discovered or provisioned nodes from all inventory files and Omnia database tables. No changes are made to the Slurm or Kubernetes cluster.

**Configurations performed by the playbook**

    * Nodes will be deleted from the Omnia DB and the xCAT node object will be deleted.
    * Telemetry services will be stopped and removed.

**To run the playbook**

Run the playbook using the following commands: ::

        cd utils
        ansible-playbook delete_node.yml -i inventory

To skip confirmation while running the playbook, use ``ansible-playbook delete_node.yml -i inventory --extra-vars skip_confirmation=yes`` or ``ansible-playbook delete_node.yml -i inventory -e  skip_confirmation=yes``.

The inventory file passed for ``delete_node.yml`` should follow the below format. ::

    [nodes]
    10.5.0.33

.. note::
    * When the node is added or deleted, the autogenerated inventories: ``amd_gpu``, ``nvidia_gpu``, ``amd_cpu``, and ``intel_cpu`` should be updated with the latest changes.
    * Nodes passed in the inventory file will be removed from the cluster. To re-provision the node, use the `add node script. <addnode.html>`_